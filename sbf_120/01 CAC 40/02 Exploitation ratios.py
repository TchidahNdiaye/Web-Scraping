# -*- coding: utf8 -*-

import requests
import pdb
import re


with open('pages_ratios/air-liquide.txt','r',encoding='utf8') as output:
    content = output.read()

d = 150

action = content[89457-d:89457+d]
sigle = content[125859-d:125859+d]
Price_to_Earnings = content[129420-d:129420+d]
Price_to_sales = content[129723-d:129723+d]
Price_to_Cash_Flow = content[130016-d:130016+d]
Price_to_Book = content[130639-d:130639+d]
Book_to_market = content[138530-d:138530+d] #(Book Value/Share)
Rendement = content[152115-d:152115+d]
g = content[152719-d:152719+d]
taux_de_distribution = content[153033-d:153033+d]

pattern1 = '<h1 class="float_lang_base_1 relativeAttr"\n\tdir="ltr" itemprop="name">(.+?(?=\t</h1>))'
action = re.findall(pattern1,content)
if action==[]:
    print("problème d\'extraction de l'action")
else:
    print(action)
    print('le prix de l\'action total est:',action)

pattern2 = '<h2 class="float_lang_base_1 inlineblock">Ratios (.+?(?=</h2>))'
sigle = re.findall(pattern2,content)
if sigle==[]:
    print("problème d\'extraction du sigle")
else:
    print(sigle)
    print('le prix de l\'action total est:',sigle)

pattern4 = 'Cours/Ventes <i class="lighterGrayFont arial_11">TTM</i></span></td>\n                                <td>(.+?(?=</td>))'
Price_to_sales = re.findall(pattern4,content)
if Price_to_sales==[]:
    print("problème d\'extraction du P\\S ratio")
else:
    print(sigle)
    print('le prix de l\'action total est:',Price_to_sales)
 
pattern5 = 'Cours/Flux de trésorerie <i class="lighterGrayFont arial_11">MRQ</i></span></td>\n                                <td>(.+?(?=</td>))'
Price_to_Cash_Flow = re.findall(pattern5,content)
if Price_to_Cash_Flow==[]:
    print("problème d\'extraction du Price_to_Cash_Flow")
else:
    print(Price_to_Cash_Flow)
    print('le Price_to_Cash_Flow est:',Price_to_Cash_Flow)

pattern6 = 'Cours/Valeur comptable <i class="lighterGrayFont arial_11">MRQ</i></span></td>\n                                <td>(.+?(?=</td>))'
Price_to_Book = re.findall(pattern6,content)
if Price_to_Cash_Flow==[]:
    print("problème d\'extraction du Price_to_Cash_Flow")
else:
    print(Price_to_Cash_Flow)
    print('le Price_to_Cash_Flow est:',Price_to_Cash_Flow)

pattern7 = 'Valeur comptable par action <i class="lighterGrayFont arial_11">MRQ</i></span></td>\n                                <td>(.+?(?=</td>))'
Book_to_market = re.findall(pattern7,content)
if Book_to_market==[]:
    print("problème d\'extraction du Book_to_market")
else:
    print(Price_to_Cash_Flow)
    print('le Book_to_market est:',Book_to_market)

pattern8 = 'Rendement action <i class="lighterGrayFont arial_11">ANN</i></span></td>\n                                <td>(.+?(?=</td>))'
Rendement = re.findall(pattern8,content)
if Price_to_Cash_Flow==[]:
    print("problème d\'extraction du Rendement")
else:
    print(Rendement)
    print('le Rendement est:',Rendement)

pattern9 = 'Taux de croissance du dividende <i class="lighterGrayFont arial_11">ANN</i></span></td>\n                                <td>(.+?(?=</td>))'
g = re.findall(pattern9,content)
if g==[]:
    print("problème d\'extraction de g")
else:
    print(g)
    print('le taux de croissance des dividendes est:',g)        
        
pattern10 = 'Ratio de distribution <i class="lighterGrayFont arial_11">TTM</i></span></td>\n                                <td>(.+?(?=</td>))'
taux_de_distribution = re.findall(pattern10,content)
if taux_de_distribution==[]:
    print("problème d\'extraction du taux_de_distribution")
else:
    print(taux_de_distribution)
    print('le taux_de_distribution est:',taux_de_distribution)

pdb.set_trace()
